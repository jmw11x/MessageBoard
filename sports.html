<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="./style.css">
    
    <style>
        body {
          font-family: "Lato", sans-serif;
        }
        
        .sidenav {
          height: 100%;
          width: 0;
          position: fixed;
          z-index: 1;
          top: 0;
          left: 0;
          background-color: rgb(141, 128, 128);
          overflow-x: hidden;
          transition: 0.5s;
          padding-top: 60px;
        }
        
        
   
        .sidenav .closebtn {
          position: absolute;
          top: 0;
          right: 25px;
          font-size: 36px;
          margin-left: 50px;
        }
        
        @media screen and (max-height: 450px) {
          .sidenav {padding-top: 15px;}
          .sidenav a {font-size: 18px;}
        }
        </style>

    <title>Document</title>
</head>
<body>
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <img onclick = "window.open('settings.html', '_self')" src="settings.jpg" alt="" class = "settings">

        <img onclick = "window.open('boards.html', '_self')" src="home.png" alt="" class = "settings">
        <br>
        Profile:<img onclick = "window.open('profile.html', '_self')" src="prof.jpg" alt="" class = "settings">

      </div>

      <span style="font-size:30px;cursor:pointer" onclick="openNav()">&#9776; open</span>
      
      <script>
      function openNav() {
        document.getElementById("mySidenav").style.width = "250px";
      }
      
      function closeNav() {
        document.getElementById("mySidenav").style.width = "0";
      }
      </script>
    <h1 class = "sports_b">Welcome to the SPORTS board braj</h1>

    <button onclick = "signOut()">Sign out</button>
    <button onclick = "addmessage()" class ="actionbtn">+</button>




    <table id = "table">
        <th>No moderation; post at your own risk</tr>
    </table>


    <script>
        
        function addmessage(){
            var message =prompt("Please enter your message");
            var user = admin.currentUser.uid;
            
            var uzrref = db.collection('users').doc(user);

            uzrref.get().then(function(doc) {
                if (doc.exists) {
                //gives full object of user
                console.log("Document data:", doc.data());
                //gives specific field 
                var name=doc.get('firstName');
                console.log(name);

                var currentdate = new Date();
                let s= new Date().toLocaleString();

                s=s.split(',')[1].substring(1);
                currentdate = currentdate.toISOString().split('T')[0]+s;

                currentdate = currentdate.toString();
                if(message != null){
                db.collection("sports").doc().set({
                    Message : message,
                    datetime:currentdate,
                    author: name,
                })
                .then(() => {
                    alert("Message added");
                })
                .catch((error) => {
                    console.error("Error writing document: ", error);
                });
            }
                } else {
                    // doc.data() will be undefined in this case
                    console.log("No such document!");
                }
                }).catch(function(error) {
                console.log("Error getting document:", error);
                });
           
            
        }
    </script>
    <script>
        function signOut() {
            admin.signOut().then(() => {
                console.log('user signed out');
                window.open('index.html', '_self');
            })
        }



    </script>
      <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
        https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-analytics.js"></script>

    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>

    <script>
        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        var firebaseConfig = {
          apiKey: "AIzaSyDvGItZ9Pht2Jh9oWHHcIJVnNrJkjA_1Sk",
          authDomain: "mobileapphw1.firebaseapp.com",
          projectId: "mobileapphw1",
          storageBucket: "mobileapphw1.appspot.com",
          messagingSenderId: "29599921082",
          appId: "1:29599921082:web:d66e1cedef4d1dcb616383",
          measurementId: "G-CWNCR6SRP5"
        };
   
    firebase.initializeApp(firebaseConfig);
    const admin = firebase.auth();
    const db = firebase.firestore();
    </script>
    <script src="sportsdb.js"></script>
</body>
</html>